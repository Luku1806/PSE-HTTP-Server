\hypertarget{http__security_8h}{}\section{C\+:/\+Users/\+Leon Franke/\+Desktop/pse2019-\/gruppe09-\/master/include/http\+\_\+security.h File Reference}
\label{http__security_8h}\index{C\+:/\+Users/\+Leon Franke/\+Desktop/pse2019-\/gruppe09-\/master/include/http\+\_\+security.\+h@{C\+:/\+Users/\+Leon Franke/\+Desktop/pse2019-\/gruppe09-\/master/include/http\+\_\+security.\+h}}
{\ttfamily \#include \char`\"{}http\+\_\+string.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}http\+\_\+parser.\+h\char`\"{}}\newline
\subsection*{Data Structures}
\begin{DoxyCompactItemize}
\item 
struct \mbox{\hyperlink{structcredentials}{credentials}}
\item 
struct \mbox{\hyperlink{structcredential_array}{credential\+Array}}
\end{DoxyCompactItemize}
\subsection*{Typedefs}
\begin{DoxyCompactItemize}
\item 
typedef struct \mbox{\hyperlink{structcredentials}{credentials}} \mbox{\hyperlink{http__security_8h_ae6f80f99f90f6db0175fb71042670b15}{http\+\_\+credentials}}
\item 
typedef struct \mbox{\hyperlink{structcredential_array}{credential\+Array}} \mbox{\hyperlink{http__security_8h_ace5789328abf1a0461fcf69733b808e7}{http\+\_\+credential\+\_\+array}}
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{structhttp__credentials}{http\+\_\+credentials}} $\ast$ \mbox{\hyperlink{http__security_8h_a2e76eca7fe3e3189c850fef43bb4a032}{new\+\_\+http\+Credentials}} ()
\item 
void \mbox{\hyperlink{http__security_8h_a78b82533d8d3f68778941c9f0971b93c}{free\+\_\+http\+Credentials}} (\mbox{\hyperlink{structhttp__credentials}{http\+\_\+credentials}} $\ast$\mbox{\hyperlink{structcredentials}{credentials}})
\item 
\mbox{\hyperlink{structhttp__credential__array}{http\+\_\+credential\+\_\+array}} $\ast$ \mbox{\hyperlink{http__security_8h_aeffa9a0e1ea042498e451bd9d86c33c8}{new\+\_\+http\+Credential\+Array}} (size\+\_\+t max)
\item 
void \mbox{\hyperlink{http__security_8h_acbc27b1a4f742f83db5927a129835edd}{free\+\_\+http\+Credential\+Array}} (\mbox{\hyperlink{structhttp__credential__array}{http\+\_\+credential\+\_\+array}} $\ast$array)
\item 
char \mbox{\hyperlink{http__security_8h_a70f6bf0e480c5ba8bfea20531417b815}{credential\+\_\+array\+\_\+add}} (\mbox{\hyperlink{structhttp__credential__array}{http\+\_\+credential\+\_\+array}} $\ast$\mbox{\hyperlink{structcredential_array}{credential\+Array}}, \mbox{\hyperlink{structhttp__credentials}{http\+\_\+credentials}} $\ast$\mbox{\hyperlink{structcredentials}{credentials}})
\item 
void \mbox{\hyperlink{http__security_8h_a98d89d24adffa0c57a5df73d0ff1986f}{print\+H\+T\+T\+P\+Credentials}} (\mbox{\hyperlink{structhttp__credentials}{http\+\_\+credentials}} $\ast$\mbox{\hyperlink{structcredentials}{credentials}})
\item 
void \mbox{\hyperlink{http__security_8h_a10c11660a52cc49c2d9ee2f3e901943b}{print\+H\+T\+T\+P\+Credential\+Array}} (\mbox{\hyperlink{structhttp__credential__array}{http\+\_\+credential\+\_\+array}} $\ast$\mbox{\hyperlink{structcredential_array}{credential\+Array}})
\item 
\mbox{\hyperlink{structstring}{string}} $\ast$ \mbox{\hyperlink{http__security_8h_ae4a66e8fdec3e334469a41908beb19f0}{encode\+S\+H\+A1}} (\mbox{\hyperlink{structstring}{string}} $\ast$to\+Encode)
\item 
\mbox{\hyperlink{structhttp__credentials}{http\+\_\+credentials}} $\ast$ \mbox{\hyperlink{http__security_8h_a2ddcc49e0bc9b213c8911bc1647eda0d}{get\+Authentication\+Credentials}} (\mbox{\hyperlink{structhttp__request}{http\+\_\+request}} $\ast$request)
\item 
char \mbox{\hyperlink{http__security_8h_a045e678124f420ca0d4f4826afad7a61}{check\+Credentials}} (\mbox{\hyperlink{structhttp__credentials}{http\+\_\+credentials}} $\ast$\mbox{\hyperlink{structcredentials}{credentials}})
\item 
\mbox{\hyperlink{structhttp__credential__array}{http\+\_\+credential\+\_\+array}} $\ast$ \mbox{\hyperlink{http__security_8h_ac3b48f4d3a0432c1ea95ebd9fe3fae5f}{load\+Credentials}} ()
\end{DoxyCompactItemize}


\subsection{Typedef Documentation}
\mbox{\Hypertarget{http__security_8h_ace5789328abf1a0461fcf69733b808e7}\label{http__security_8h_ace5789328abf1a0461fcf69733b808e7}} 
\index{http\+\_\+security.\+h@{http\+\_\+security.\+h}!http\+\_\+credential\+\_\+array@{http\+\_\+credential\+\_\+array}}
\index{http\+\_\+credential\+\_\+array@{http\+\_\+credential\+\_\+array}!http\+\_\+security.\+h@{http\+\_\+security.\+h}}
\subsubsection{\texorpdfstring{http\+\_\+credential\+\_\+array}{http\_credential\_array}}
{\footnotesize\ttfamily typedef struct \mbox{\hyperlink{structcredential_array}{credential\+Array}}  \mbox{\hyperlink{structhttp__credential__array}{http\+\_\+credential\+\_\+array}}}

\mbox{\Hypertarget{http__security_8h_ae6f80f99f90f6db0175fb71042670b15}\label{http__security_8h_ae6f80f99f90f6db0175fb71042670b15}} 
\index{http\+\_\+security.\+h@{http\+\_\+security.\+h}!http\+\_\+credentials@{http\+\_\+credentials}}
\index{http\+\_\+credentials@{http\+\_\+credentials}!http\+\_\+security.\+h@{http\+\_\+security.\+h}}
\subsubsection{\texorpdfstring{http\+\_\+credentials}{http\_credentials}}
{\footnotesize\ttfamily typedef struct \mbox{\hyperlink{structcredentials}{credentials}}  \mbox{\hyperlink{structhttp__credentials}{http\+\_\+credentials}}}



\subsection{Function Documentation}
\mbox{\Hypertarget{http__security_8h_a045e678124f420ca0d4f4826afad7a61}\label{http__security_8h_a045e678124f420ca0d4f4826afad7a61}} 
\index{http\+\_\+security.\+h@{http\+\_\+security.\+h}!check\+Credentials@{check\+Credentials}}
\index{check\+Credentials@{check\+Credentials}!http\+\_\+security.\+h@{http\+\_\+security.\+h}}
\subsubsection{\texorpdfstring{check\+Credentials()}{checkCredentials()}}
{\footnotesize\ttfamily char check\+Credentials (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structhttp__credentials}{http\+\_\+credentials}} $\ast$}]{credentials }\end{DoxyParamCaption})}

Checks the credentials against the all credentials of the .htpasswd file. Returns 0 if no match was found, 1 if given credentials match an entry of the file.


\begin{DoxyParams}{Parameters}
{\em credentials} & The credentials to check if they exist in the .htpasswd file. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 if no match was found in the file, 1 if there was a match to an entry. 
\end{DoxyReturn}
\mbox{\Hypertarget{http__security_8h_a70f6bf0e480c5ba8bfea20531417b815}\label{http__security_8h_a70f6bf0e480c5ba8bfea20531417b815}} 
\index{http\+\_\+security.\+h@{http\+\_\+security.\+h}!credential\+\_\+array\+\_\+add@{credential\+\_\+array\+\_\+add}}
\index{credential\+\_\+array\+\_\+add@{credential\+\_\+array\+\_\+add}!http\+\_\+security.\+h@{http\+\_\+security.\+h}}
\subsubsection{\texorpdfstring{credential\+\_\+array\+\_\+add()}{credential\_array\_add()}}
{\footnotesize\ttfamily char credential\+\_\+array\+\_\+add (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structhttp__credential__array}{http\+\_\+credential\+\_\+array}} $\ast$}]{credential\+Array,  }\item[{\mbox{\hyperlink{structhttp__credentials}{http\+\_\+credentials}} $\ast$}]{credentials }\end{DoxyParamCaption})}

Adds a credential to the array. Returns 1 if the credentials fit into the array, 0 if its already full.


\begin{DoxyParams}{Parameters}
{\em \mbox{\hyperlink{structcredential_array}{credential\+Array}}} & The array to add something to. \\
\hline
{\em credentials} & The credentials pointer to add to the array. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 if array is already full, 1 if everything was okay. 
\end{DoxyReturn}
\mbox{\Hypertarget{http__security_8h_ae4a66e8fdec3e334469a41908beb19f0}\label{http__security_8h_ae4a66e8fdec3e334469a41908beb19f0}} 
\index{http\+\_\+security.\+h@{http\+\_\+security.\+h}!encode\+S\+H\+A1@{encode\+S\+H\+A1}}
\index{encode\+S\+H\+A1@{encode\+S\+H\+A1}!http\+\_\+security.\+h@{http\+\_\+security.\+h}}
\subsubsection{\texorpdfstring{encode\+S\+H\+A1()}{encodeSHA1()}}
{\footnotesize\ttfamily \mbox{\hyperlink{structstring}{string}}$\ast$ encode\+S\+H\+A1 (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structstring}{string}} $\ast$}]{to\+Encode }\end{DoxyParamCaption})}

Hashes a string with S\+H\+A1 using openssl.


\begin{DoxyParams}{Parameters}
{\em to\+Encode} & The string to hash. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The hashed string. 
\end{DoxyReturn}
\mbox{\Hypertarget{http__security_8h_acbc27b1a4f742f83db5927a129835edd}\label{http__security_8h_acbc27b1a4f742f83db5927a129835edd}} 
\index{http\+\_\+security.\+h@{http\+\_\+security.\+h}!free\+\_\+http\+Credential\+Array@{free\+\_\+http\+Credential\+Array}}
\index{free\+\_\+http\+Credential\+Array@{free\+\_\+http\+Credential\+Array}!http\+\_\+security.\+h@{http\+\_\+security.\+h}}
\subsubsection{\texorpdfstring{free\+\_\+http\+Credential\+Array()}{free\_httpCredentialArray()}}
{\footnotesize\ttfamily void free\+\_\+http\+Credential\+Array (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structhttp__credential__array}{http\+\_\+credential\+\_\+array}} $\ast$}]{array }\end{DoxyParamCaption})}

Frees the memory allocated for the \mbox{\hyperlink{structhttp__credential__array}{http\+\_\+credential\+\_\+array}} pointer. 
\begin{DoxyParams}{Parameters}
{\em request} & The credential\+\_\+array pointer to free. \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{http__security_8h_a78b82533d8d3f68778941c9f0971b93c}\label{http__security_8h_a78b82533d8d3f68778941c9f0971b93c}} 
\index{http\+\_\+security.\+h@{http\+\_\+security.\+h}!free\+\_\+http\+Credentials@{free\+\_\+http\+Credentials}}
\index{free\+\_\+http\+Credentials@{free\+\_\+http\+Credentials}!http\+\_\+security.\+h@{http\+\_\+security.\+h}}
\subsubsection{\texorpdfstring{free\+\_\+http\+Credentials()}{free\_httpCredentials()}}
{\footnotesize\ttfamily void free\+\_\+http\+Credentials (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structhttp__credentials}{http\+\_\+credentials}} $\ast$}]{credentials }\end{DoxyParamCaption})}

Frees the memory allocated for the http\+Credential pointer. 
\begin{DoxyParams}{Parameters}
{\em request} & The credential pointer to free. \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{http__security_8h_a2ddcc49e0bc9b213c8911bc1647eda0d}\label{http__security_8h_a2ddcc49e0bc9b213c8911bc1647eda0d}} 
\index{http\+\_\+security.\+h@{http\+\_\+security.\+h}!get\+Authentication\+Credentials@{get\+Authentication\+Credentials}}
\index{get\+Authentication\+Credentials@{get\+Authentication\+Credentials}!http\+\_\+security.\+h@{http\+\_\+security.\+h}}
\subsubsection{\texorpdfstring{get\+Authentication\+Credentials()}{getAuthenticationCredentials()}}
{\footnotesize\ttfamily \mbox{\hyperlink{structhttp__credentials}{http\+\_\+credentials}}$\ast$ get\+Authentication\+Credentials (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structhttp__request}{http\+\_\+request}} $\ast$}]{request }\end{DoxyParamCaption})}

Reads the authentication credentials for basic authentication from a given request and returns them. If authentication scheme is not Basic, no authentication credentials are given, or something is wrong about the credentials, N\+U\+LL is returned.


\begin{DoxyParams}{Parameters}
{\em request} & The request to get the credentials from. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The authentication credentials from the request. N\+U\+LL if they are not set or something is bad about the syntax. 
\end{DoxyReturn}
\mbox{\Hypertarget{http__security_8h_ac3b48f4d3a0432c1ea95ebd9fe3fae5f}\label{http__security_8h_ac3b48f4d3a0432c1ea95ebd9fe3fae5f}} 
\index{http\+\_\+security.\+h@{http\+\_\+security.\+h}!load\+Credentials@{load\+Credentials}}
\index{load\+Credentials@{load\+Credentials}!http\+\_\+security.\+h@{http\+\_\+security.\+h}}
\subsubsection{\texorpdfstring{load\+Credentials()}{loadCredentials()}}
{\footnotesize\ttfamily \mbox{\hyperlink{structhttp__credential__array}{http\+\_\+credential\+\_\+array}}$\ast$ load\+Credentials (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}

\mbox{\Hypertarget{http__security_8h_aeffa9a0e1ea042498e451bd9d86c33c8}\label{http__security_8h_aeffa9a0e1ea042498e451bd9d86c33c8}} 
\index{http\+\_\+security.\+h@{http\+\_\+security.\+h}!new\+\_\+http\+Credential\+Array@{new\+\_\+http\+Credential\+Array}}
\index{new\+\_\+http\+Credential\+Array@{new\+\_\+http\+Credential\+Array}!http\+\_\+security.\+h@{http\+\_\+security.\+h}}
\subsubsection{\texorpdfstring{new\+\_\+http\+Credential\+Array()}{new\_httpCredentialArray()}}
{\footnotesize\ttfamily \mbox{\hyperlink{structhttp__credential__array}{http\+\_\+credential\+\_\+array}}$\ast$ new\+\_\+http\+Credential\+Array (\begin{DoxyParamCaption}\item[{size\+\_\+t}]{max }\end{DoxyParamCaption})}

Creates (allocates) a new \mbox{\hyperlink{structhttp__credential__array}{http\+\_\+credential\+\_\+array}} of size max and returns a pointer to it.


\begin{DoxyParams}{Parameters}
{\em max} & The maximum of credentials this array can hold. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The pointer to the allocated \mbox{\hyperlink{structhttp__credential__array}{http\+\_\+credential\+\_\+array}}. 
\end{DoxyReturn}
\mbox{\Hypertarget{http__security_8h_a2e76eca7fe3e3189c850fef43bb4a032}\label{http__security_8h_a2e76eca7fe3e3189c850fef43bb4a032}} 
\index{http\+\_\+security.\+h@{http\+\_\+security.\+h}!new\+\_\+http\+Credentials@{new\+\_\+http\+Credentials}}
\index{new\+\_\+http\+Credentials@{new\+\_\+http\+Credentials}!http\+\_\+security.\+h@{http\+\_\+security.\+h}}
\subsubsection{\texorpdfstring{new\+\_\+http\+Credentials()}{new\_httpCredentials()}}
{\footnotesize\ttfamily \mbox{\hyperlink{structhttp__credentials}{http\+\_\+credentials}}$\ast$ new\+\_\+http\+Credentials (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}

Creates (allocates) a new http\+Credential and returns a pointer to it. \begin{DoxyReturn}{Returns}
The pointer to the allocated http\+Credential. 
\end{DoxyReturn}
\mbox{\Hypertarget{http__security_8h_a10c11660a52cc49c2d9ee2f3e901943b}\label{http__security_8h_a10c11660a52cc49c2d9ee2f3e901943b}} 
\index{http\+\_\+security.\+h@{http\+\_\+security.\+h}!print\+H\+T\+T\+P\+Credential\+Array@{print\+H\+T\+T\+P\+Credential\+Array}}
\index{print\+H\+T\+T\+P\+Credential\+Array@{print\+H\+T\+T\+P\+Credential\+Array}!http\+\_\+security.\+h@{http\+\_\+security.\+h}}
\subsubsection{\texorpdfstring{print\+H\+T\+T\+P\+Credential\+Array()}{printHTTPCredentialArray()}}
{\footnotesize\ttfamily void print\+H\+T\+T\+P\+Credential\+Array (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structhttp__credential__array}{http\+\_\+credential\+\_\+array}} $\ast$}]{credential\+Array }\end{DoxyParamCaption})}

Prints the given credential array (all credentials it contains) to the console. 
\begin{DoxyParams}{Parameters}
{\em credentials} & The credential array to print to the console. \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{http__security_8h_a98d89d24adffa0c57a5df73d0ff1986f}\label{http__security_8h_a98d89d24adffa0c57a5df73d0ff1986f}} 
\index{http\+\_\+security.\+h@{http\+\_\+security.\+h}!print\+H\+T\+T\+P\+Credentials@{print\+H\+T\+T\+P\+Credentials}}
\index{print\+H\+T\+T\+P\+Credentials@{print\+H\+T\+T\+P\+Credentials}!http\+\_\+security.\+h@{http\+\_\+security.\+h}}
\subsubsection{\texorpdfstring{print\+H\+T\+T\+P\+Credentials()}{printHTTPCredentials()}}
{\footnotesize\ttfamily void print\+H\+T\+T\+P\+Credentials (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structhttp__credentials}{http\+\_\+credentials}} $\ast$}]{credentials }\end{DoxyParamCaption})}

Prints the given credentials to the console. 
\begin{DoxyParams}{Parameters}
{\em credentials} & The credentials to print to the console. \\
\hline
\end{DoxyParams}
