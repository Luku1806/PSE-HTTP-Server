<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Documentation: PSE-HTTP-SERVER-09</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="ein leerzeichen.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Documentation
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">PSE-HTTP-SERVER-09 </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h2>Introduction</h2>
<p>This repository contains a simple implementation of an http webserver, together with its test, a doxygen documentation and a sample document root.</p>
<h2>Features</h2>
<ul>
<li>Simple content serving from 3 different web roots (1 "protected" with basic authentication)</li>
<li>Basic authentication with standard htpasswd file (SHA1 only)</li>
</ul>
<h2>Installation</h2>
<p>The makefile provides 2 ways of installing and running the server. There is a <a href="#manual-installation">manual way</a>, and a <a href="#automatic-installation">full installation</a>, which even populates the content folders.</p>
<p>No matter which way you prefer, you have to do the initial preparation and then continue with the <a href="#manual-installation">manual way</a> or the <a href="#automatic-installation">automatic way</a>. </p><hr/>
<h4>Preperation</h4>
<ol type="1">
<li><p class="startli">Install git and make</p>
<p class="startli">Example for Debian/Ubuntu: </p><pre class="fragment">sudo apt-get install git build-essential -y
</pre></li>
<li><p class="startli">Install the needed libraries, if they are not already installed.</p>
<p class="startli">OpenSSL and the Magic library are needed.</p>
<p class="startli">Example for Debian/Ubuntu: </p><pre class="fragment">sudo apt-get install libmagic-dev   # Install Magic
sudo apt-get install libssl-dev     # Install OpenSSL
</pre></li>
<li><p class="startli">Clone the git repository to a folder you like to run the program from.</p>
<p class="startli">For this example we will assume that we clone to */home/user/documents* and reference it through the whole readme.</p>
<p class="startli">Example if you have a valid ssh key added to GitLab: </p><pre class="fragment">cd /home/user/documents
git clone ssh://git@git.fh-muenster.de:2323/lr413680/pse2019-gruppe09.git
</pre><p class="startli">Example if you want to use http, in this case you will be asked for your GitLab credentials: </p><pre class="fragment">cd /home/user/documents     
git clone https://git@git.fh-muenster.de:2323/lr413680/pse2019-gruppe09.git
</pre></li>
<li>Now go into the newly created folder with the project in it by calling <pre class="fragment">cd ./pse2019-gruppe09/
</pre></li>
<li><p class="startli">Do the <a href="#settings">settings</a> you want by editing <a href="include/http_settings.h">http_settings.h</a>. <b>This has to be done before the build with make</b>!</p>
<p class="startli">For example you can change the server port and buffersize and give it a unique name.</p>
<p class="startli"><b>Note: Please only change the path settings, if you are using manual installation, because automatic installation only works with the standard folders! All other settings can be changed as you want.</b></p>
</li>
</ol>
<p>Now we are ready to do the final installation by using <b>one</b> of the two ways.</p>
<p>The <a href="#automatic-installation">automatic version</a> is the preferred one because of convenience. </p><hr/>
<h4>Automatic installation</h4>
<p>If you install the program this way, the built executable will be copied to /usr/local/bin and you can call it from anywhere. For this you need to be able to call sudo.</p>
<p>Also the standard webroot is copied to /usr/local/webroot so you wont have to do anything.</p>
<p><b>IMPORTANT: For automatic installation it is required that all paths are default in the <a href="#paths">settings</a>, otherwise the webroot wont be found!</b></p>
<ol type="1">
<li>Build the executable by calling make (you have to still be in the folder where you ended preperation) <pre class="fragment">make
</pre></li>
<li>Call make install, to copy everything to the right place. For this you need to call it with sudo or the current user has to have write right to /usr/local/. <pre class="fragment">sudo make install
</pre></li>
<li>At this point you should call make clean, even if it is not necessary <pre class="fragment">make clean
</pre></li>
<li>Now the program is installed and can be called <b>system wide</b> by simply calling <pre class="fragment">http_server
</pre></li>
</ol>
<hr/>
<h4>Automatic uninstall</h4>
<p>If you dont longer need the server it can be deinstalled automatically. This will only work if the program was installed the <a href="#automatic-installation">automatic way</a>!</p>
<p>To do so, simply call:</p>
<p>sudo make uninstall</p>
<p><em>This will delete the executable and the whole webroot. Keep that in mind to not loose your websites!</em> </p><hr/>
<h4>Manual installation</h4>
<ol type="1">
<li><p class="startli">Copy the [webroot](webroot) to the path specified in the <a href="#paths">settings</a>. You can also create the folders yourself, and directly put your own website, htpasswd and status pages.</p>
<p class="startli">Keep in mind that every path can be set to somewhere else, so simply copying the [webroot](webroot) may not work!</p>
</li>
<li>Build the executable by calling make (you have to still be in the folder where you ended preperation) <pre class="fragment">make
</pre></li>
<li><p class="startli">In the folder you now find the executable called <em>http_server</em>. This file can be copied to anywhere you want, but for now we will assume that you leve it where it is.</p>
<p class="startli">Now if you are still in the folder where the file lies, you can start the server by calling: </p><pre class="fragment">./http_server
</pre><p class="startli">or if you are not in the folder where the file lies: </p><pre class="fragment">/home/user/documents/pse2019-gruppe09/http_server
</pre></li>
</ol>
<hr/>
<p><em>Note: If you want to serve your own websites, simply put them into the webroot folders for the different host, specified in the <a href="#paths">settings</a></em>.</p>
<h2>Testing</h2>
<p>The repository contains a test suite running in python, that checks each function of the server for normal operation.</p>
<p>After the installation of the server, you can confirm that everything is configured properly by running the tests.</p>
<h4>Python</h4>
<p>If Python 3 is not installed already, you have to do it now by calling: </p><pre class="fragment">sudo apt-get install python3
</pre><h4>Running the test</h4>
<p>Now to run the test, start the server, navigate to the [test folder](test) in the project folder (/home/user/documents/pse2019-gruppe09/test in our example) and run the test: </p><pre class="fragment">http_server
cd /home/user/documents/pse2019-gruppe09/test
python3 tests.py
</pre><p>When the program is finished, you can look at the output. The program will show a summary showing the number of failures and successful requests. If a test failed, scroll up to see which one it was, and what went wrong.</p>
<p><em>Note: If all tests fail and the failure is</em> </p><pre class="fragment">"Connecting failed: [Errno 111] Connection refused"
</pre><p><em>check the <a href="#port">port</a> in the settings. If you changed it, you have to change it at the beginning of <a href="test/tests.py">test.py</a> too!</em></p>
<h2>Settings</h2>
<p><b>Settings have to be done before the build is done.</b> To change the settings, open <a href="include/http_settings.h">http_settings.h</a> and edit it to your needs:</p>
<h4>General</h4>
<ul>
<li><p class="startli">##### SERVER_NAME The name of the server to be put into the HTTP responses.</p>
<p class="startli">Default: </p><pre class="fragment">#define SERVER_NAME "HTTP-Server 09 1.0"
</pre></li>
<li><p class="startli">##### HTTP_VERSION The HTTP version to be send in the header.</p>
<p class="startli"><b>Please only change if you know what you are doing, because the server is HTTP/1.1 changing this could make it incompatible to any browser!</b></p>
<p class="startli">Default: </p><pre class="fragment">#define HTTP_VERSION "HTTP/1.1"
</pre></li>
</ul>
<h4>General</h4>
<ul>
<li><p class="startli">##### PORT The tcp port, the server listens on for requests. For usage of http standard port 80, the program has to be run as superuser so it is not used by default.</p>
<p class="startli">Default: </p><pre class="fragment">#define PORT 31337
</pre></li>
<li><p class="startli">##### BUFFER_SIZE The size of the buffer, used for reading messages from the tcp connection. Choose an appropriate size, if it is to small, longer messages can not be responded to. But keep in mind that the memory has to be allocated, so it also can not be infinitely huge.</p>
<p class="startli">The value has to be given in bytes.</p>
<p class="startli">Default: </p><pre class="fragment">#define PORT 31337
</pre></li>
</ul>
<h4>Paths</h4>
<ul>
<li><p class="startli">##### DEFAULT_DOCUMENT_ROOT This is the path where all files that should be served when no special host is requested or the host is unknown lie.</p>
<p class="startli">Default: </p><pre class="fragment">#define DEFAULT_DOCUMENT_ROOT "/usr/local/webroot/default/"
</pre></li>
<li><p class="startli">##### EXTERN_DOCUMENT_ROOT This is the path where all files that should be served when the host "extern" is requested lie.</p>
<p class="startli">Default: </p><pre class="fragment">#define EXTERN_DOCUMENT_ROOT "/usr/local/webroot/extern/"
</pre></li>
<li><p class="startli">##### INTERN_DOCUMENT_ROOT This is the path where all files that should be served when the host "intern" is requested lie. Keep in mind that this document root, is "protected" via basic authentication. The credentials lie in the htpasswd file.</p>
<p class="startli">Default: </p><pre class="fragment">#define INTERN_DOCUMENT_ROOT "/usr/local/webroot/intern/"
</pre></li>
<li><p class="startli">##### STATUS_SITE_PATH This path contains all status pages. Each status page is named after its status. Each status has its own site, and any html file with a fitting name can be used.</p>
<p class="startli">For example a page for status 505 is named: "505.html"</p>
<p class="startli">Default: </p><pre class="fragment">#define STATUS_SITE_PATH "/usr/local/webroot/status/"
</pre></li>
<li><p class="startli">##### HTPASSWD_PATH This path contains the htpasswd file. The server only supports SHA1 encrypted credentials, so keep in mind to set the -s flag when creating credentials with htpasswd.</p>
<p class="startli">This file can be created by the command: </p><pre class="fragment">htpasswd -s -c htpasswd [username]
</pre><p class="startli">Using this command, the htpasswd file will be created or updated, the user [username] will be created and you will be promted to type in a password for the new user.</p>
<p class="startli">Default: </p><pre class="fragment">#define HTPASSWD_PATH "/usr/local/webroot/htpasswd" </pre> </li>
</ul>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.14
</small></address>
</body>
</html>
